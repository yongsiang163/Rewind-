<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<title>Rewind</title>
<link rel="apple-touch-icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALQAAAC0CAIAAACyr5FlAAAFZ0lEQVR4nO3dTW7cRhBAYToIYAg2fDwtdBlBl9HC5zMQZJdFAwQzMzViN6vrr9+3jmVN8aWaQwmeb79+vGzAI395fwOIizggIg6IiAMi4oCIOCAiDoiIAyLigIg4ICIOiIgDIuKA6G/vb8DBz5fvA3/qzz//qn8nwdWPYyyFM1+nfC4149AK4vzfUjKUOnHYBHHmby8TSvo4fJt4aP+WsleSOI6AWdxo32HeRPLFEb+JG3kXSaY40mVxI90iyRFH9iyOEiUSPY5KWRylSCT04/OqZeyCv8CgmyP41BRFXiHh4lgni6OYicQ6VtYsYxft5QeKI9poXIQaQohjJdRE3MU5Yvw3B2U8FGEsznFEGEFY7sNxO1bcX3kKvkeMz+agjC5e43KIgzIGuAzNOg7KGGY/OtM4KOMi4wHaxUEZKizHaBQHZSgyG6ZFHJShzmak0+OgjEkMBuv/+BxhzY2DtTHV7PFOjIMyDEwd8qw4KMPMvFFzzwHRlDhYG8YmDVw/DspwMWPsynFQhiP14XPPAZHmb4K5r43fH28n/8vX98/hr9z7Zy39fPmu+GtjIX77PJc9lMiVqFA7VtzXhr3zi8qS4oXQiWPBMprfH28BE9G6HNyQKgjYhwqFOJZdG0fR+lC5KGwONdH6uO5qHKyNo1B9XL80bA6ILsXB2rhXaXmwOSAiDn2hlscV44/PVz5T9gfn8Tu48tMWNsclr++fD3/CEj+aMwbjWHlt3Av+E7jhi8Xm0BG8jzHEAdFIHJwpD90sj1C3HWOXjM0BEXFoKnbnQRwQdcfBDUdSAxeOzQERcUBEHBD1xcENx3Ohnm3c6718bA6IiEPNzdoo8MyDOCAiDh3B7zbGEIeCkmVsXb8myFuVe1IWYW84un5rkH+CYUTVVXGDY0Vf2LXRizggIg5lZdbGRhx4gjg0VVobG3EoKlbGRhxa6pWxEccZXz7VKFnGxkOw55bNomFziBZ5DPoEcTxw/l8XrR0QcTxQ+7A4jziuKrw8iOOxruVRtQ/iEHG4EIeOksujIw7FT3nJot7h0nUR2RwQEccX6i2P84jja8v2QRwQEccpay6PvjgWfMOyK9BH7+Vjc0BEHB0KLI8uxNFnqWfq3XGsfNvRK9TyGLhwbI5u6xwuxDFikcOFOKbLuzxG4uC2Y8t2uIxdMjYHRMQxLtfyGDAYBydLk6IPPh0S+sbjYHk0wZfHlcvE5lAQvI9hxAHRpTg4WXYxl8fFC8TmUFPvmfrVOFgeYwyWx/VLw+bQFPNwGaYQB8vjKMjhonJR2Byegi8PnThYHkcnl8fr++ekNaN1OdQ2B310mXf6KF4IjpUpnlz7eQtD3bdfP14Uvxwf2HNk/5GAuvubzWEky7Y4Ut4cG8vj/35/vJlloX7bpx/HRh8eZrwhmHKs8M7F2KSBc88B0aw4WB5m5o164uagDwNThzz3WKGPqWaPl3sOiKbHwfKYxGCwFpuDPtTZjNToWKEPRWbDtLvnoA8VlmM0vSGlj4uMB2j9boU+htmPzuGtLH0McBmaz3MO+ujiNS63Dx1uL5gf7j/n+3+R8xNSVsgT7sPxf3zuPoKYIowlxGfZc8QcRcii8d8cuzhDcRRqCIHi2IKNxl60lx/iWDla84iJlkUTLo5mnURiZtHEOlZuRB6ciuAvMOjm2FVdIcGzaKLH0VRKJEUWTY44muyJJMqiyRRHs484SyXpmtjli2MXf5HkzaJJHEcTcJFkb2KXPo7d8ZLYh1ImiKM6cRzZhFIyiKOacRzdX8KxXMqncK9+HPcWvMxjQj8+hy/igIg4ICIOiIgDIuKAiDggIg6IiAMi4oCIOCAiDoiIA6L/ANM3zXjR+SvfAAAAAElFTkSuQmCC">
<link rel="apple-touch-icon-precomposed" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALQAAAC0CAIAAACyr5FlAAAFZ0lEQVR4nO3dTW7cRhBAYToIYAg2fDwtdBlBl9HC5zMQZJdFAwQzMzViN6vrr9+3jmVN8aWaQwmeb79+vGzAI395fwOIizggIg6IiAMi4oCIOCAiDoiIAyLigIg4ICIOiIgDIuKA6G/vb8DBz5fvA3/qzz//qn8nwdWPYyyFM1+nfC4149AK4vzfUjKUOnHYBHHmby8TSvo4fJt4aP+WsleSOI6AWdxo32HeRPLFEb+JG3kXSaY40mVxI90iyRFH9iyOEiUSPY5KWRylSCT04/OqZeyCv8CgmyP41BRFXiHh4lgni6OYicQ6VtYsYxft5QeKI9poXIQaQohjJdRE3MU5Yvw3B2U8FGEsznFEGEFY7sNxO1bcX3kKvkeMz+agjC5e43KIgzIGuAzNOg7KGGY/OtM4KOMi4wHaxUEZKizHaBQHZSgyG6ZFHJShzmak0+OgjEkMBuv/+BxhzY2DtTHV7PFOjIMyDEwd8qw4KMPMvFFzzwHRlDhYG8YmDVw/DspwMWPsynFQhiP14XPPAZHmb4K5r43fH28n/8vX98/hr9z7Zy39fPmu+GtjIX77PJc9lMiVqFA7VtzXhr3zi8qS4oXQiWPBMprfH28BE9G6HNyQKgjYhwqFOJZdG0fR+lC5KGwONdH6uO5qHKyNo1B9XL80bA6ILsXB2rhXaXmwOSAiDn2hlscV44/PVz5T9gfn8Tu48tMWNsclr++fD3/CEj+aMwbjWHlt3Av+E7jhi8Xm0BG8jzHEAdFIHJwpD90sj1C3HWOXjM0BEXFoKnbnQRwQdcfBDUdSAxeOzQERcUBEHBD1xcENx3Ohnm3c6718bA6IiEPNzdoo8MyDOCAiDh3B7zbGEIeCkmVsXb8myFuVe1IWYW84un5rkH+CYUTVVXGDY0Vf2LXRizggIg5lZdbGRhx4gjg0VVobG3EoKlbGRhxa6pWxEccZXz7VKFnGxkOw55bNomFziBZ5DPoEcTxw/l8XrR0QcTxQ+7A4jziuKrw8iOOxruVRtQ/iEHG4EIeOksujIw7FT3nJot7h0nUR2RwQEccX6i2P84jja8v2QRwQEccpay6PvjgWfMOyK9BH7+Vjc0BEHB0KLI8uxNFnqWfq3XGsfNvRK9TyGLhwbI5u6xwuxDFikcOFOKbLuzxG4uC2Y8t2uIxdMjYHRMQxLtfyGDAYBydLk6IPPh0S+sbjYHk0wZfHlcvE5lAQvI9hxAHRpTg4WXYxl8fFC8TmUFPvmfrVOFgeYwyWx/VLw+bQFPNwGaYQB8vjKMjhonJR2Byegi8PnThYHkcnl8fr++ekNaN1OdQ2B310mXf6KF4IjpUpnlz7eQtD3bdfP14Uvxwf2HNk/5GAuvubzWEky7Y4Ut4cG8vj/35/vJlloX7bpx/HRh8eZrwhmHKs8M7F2KSBc88B0aw4WB5m5o164uagDwNThzz3WKGPqWaPl3sOiKbHwfKYxGCwFpuDPtTZjNToWKEPRWbDtLvnoA8VlmM0vSGlj4uMB2j9boU+htmPzuGtLH0McBmaz3MO+ujiNS63Dx1uL5gf7j/n+3+R8xNSVsgT7sPxf3zuPoKYIowlxGfZc8QcRcii8d8cuzhDcRRqCIHi2IKNxl60lx/iWDla84iJlkUTLo5mnURiZtHEOlZuRB6ciuAvMOjm2FVdIcGzaKLH0VRKJEUWTY44muyJJMqiyRRHs484SyXpmtjli2MXf5HkzaJJHEcTcJFkb2KXPo7d8ZLYh1ImiKM6cRzZhFIyiKOacRzdX8KxXMqncK9+HPcWvMxjQj8+hy/igIg4ICIOiIgDIuKAiDggIg6IiAMi4oCIOCAiDoiIA6L/ANM3zXjR+SvfAAAAAElFTkSuQmCC">
<meta name="apple-mobile-web-app-title" content="Rewind">
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;1,300;1,400&family=DM+Sans:wght@300;400&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0e0b09;
    --surface: #1a1410;
    --surface2: #221c16;
    --warm: #c4956a;
    --warm-soft: #8b6540;
    --warm-glow: rgba(196, 149, 106, 0.12);
    --text: #e8ddd4;
    --text-soft: #9a8878;
    --text-muted: #5a4e45;
    --border: rgba(196, 149, 106, 0.15);
    --border-soft: rgba(255,255,255,0.05);
  }

  * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

  html, body {
    height: 100%;
    overflow: hidden;
    background: var(--bg);
    color: var(--text);
    font-family: 'DM Sans', sans-serif;
    font-weight: 300;
  }

  /* Ambient background */
  .ambient {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 0;
  }

  .ambient-orb {
    position: absolute;
    border-radius: 50%;
    filter: blur(80px);
    opacity: 0;
    transition: opacity 3s ease;
  }

  .ambient-orb.a1 {
    width: 300px; height: 300px;
    background: radial-gradient(circle, rgba(196,149,106,0.15), transparent 70%);
    top: -80px; right: -60px;
  }

  .ambient-orb.a2 {
    width: 250px; height: 250px;
    background: radial-gradient(circle, rgba(139,101,64,0.1), transparent 70%);
    bottom: 10%; left: -80px;
  }

  .ambient-orb.visible { opacity: 1; }

  /* Grain overlay */
  .grain {
    position: fixed;
    inset: 0;
    z-index: 1;
    pointer-events: none;
    opacity: 0.03;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
    background-size: 128px;
  }

  /* Main layout */
  .app {
    position: relative;
    z-index: 2;
    height: 100%;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }

  /* Screens */
  .screen {
    position: absolute;
    inset: 0;
    display: flex;
    flex-direction: column;
    padding: 0 28px;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.6s ease, transform 0.6s ease;
    transform: translateY(12px);
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
  }

  .screen.active {
    opacity: 1;
    pointer-events: all;
    transform: translateY(0);
  }

  .screen.exit {
    opacity: 0;
    transform: translateY(-12px);
  }

  /* â”€â”€ WELCOME SCREEN â”€â”€ */
  #screen-welcome {
    justify-content: center;
    align-items: center;
    text-align: center;
    gap: 0;
  }

  .welcome-time {
    font-size: 13px;
    letter-spacing: 3px;
    text-transform: uppercase;
    color: var(--text-muted);
    margin-bottom: 48px;
    opacity: 0;
    animation: fadeUp 0.8s ease 0.3s forwards;
  }

  .rewind-logo {
    font-family: 'Cormorant Garamond', serif;
    font-size: 52px;
    font-weight: 300;
    color: var(--warm);
    letter-spacing: 8px;
    text-transform: uppercase;
    margin-bottom: 12px;
    opacity: 0;
    animation: fadeUp 0.8s ease 0.5s forwards;
  }

  .rewind-tagline {
    font-size: 13px;
    color: var(--text-muted);
    letter-spacing: 1px;
    margin-bottom: 72px;
    opacity: 0;
    animation: fadeUp 0.8s ease 0.7s forwards;
  }

  .welcome-question {
    font-family: 'Cormorant Garamond', serif;
    font-size: 26px;
    font-weight: 300;
    font-style: italic;
    color: var(--text);
    line-height: 1.5;
    margin-bottom: 48px;
    opacity: 0;
    animation: fadeUp 0.8s ease 0.9s forwards;
  }

  .returning-msg {
    display: none;
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 16px 20px;
    margin-bottom: 40px;
    font-size: 14px;
    color: var(--text-soft);
    line-height: 1.6;
    text-align: left;
    opacity: 0;
    animation: fadeUp 0.8s ease 0.9s forwards;
  }

  .returning-msg.show { display: block; }

  .returning-msg .days-away {
    font-family: 'Cormorant Garamond', serif;
    font-size: 18px;
    color: var(--warm);
    display: block;
    margin-bottom: 6px;
  }

  .begin-btn {
    background: transparent;
    border: 1px solid var(--border);
    color: var(--warm);
    font-family: 'DM Sans', sans-serif;
    font-size: 13px;
    letter-spacing: 3px;
    text-transform: uppercase;
    padding: 16px 40px;
    border-radius: 40px;
    cursor: pointer;
    transition: all 0.3s ease;
    opacity: 0;
    animation: fadeUp 0.8s ease 1.1s forwards;
  }

  .begin-btn:active {
    background: var(--warm-glow);
    border-color: var(--warm);
    transform: scale(0.97);
  }

  /* â”€â”€ CHECK-IN SCREEN â”€â”€ */
  #screen-checkin {
    padding-top: 72px;
    padding-bottom: 40px;
  }

  .checkin-step {
    display: none;
    flex-direction: column;
    min-height: calc(100vh - 112px);
  }

  .checkin-step.active { display: flex; }

  .step-indicator {
    display: flex;
    gap: 6px;
    margin-bottom: 48px;
  }

  .step-dot {
    width: 24px;
    height: 2px;
    border-radius: 2px;
    background: var(--text-muted);
    transition: background 0.4s, width 0.4s;
  }

  .step-dot.done { background: var(--warm-soft); }
  .step-dot.active { background: var(--warm); width: 40px; }

  .step-q {
    font-family: 'Cormorant Garamond', serif;
    font-size: 28px;
    font-weight: 300;
    font-style: italic;
    color: var(--text);
    line-height: 1.45;
    margin-bottom: 12px;
  }

  .step-sub {
    font-size: 13px;
    color: var(--text-muted);
    margin-bottom: 40px;
    line-height: 1.6;
  }

  /* Mood selector */
  .mood-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 10px;
    margin-bottom: 32px;
  }

  .mood-btn {
    background: var(--surface);
    border: 1px solid var(--border-soft);
    border-radius: 12px;
    padding: 18px 14px;
    cursor: pointer;
    text-align: center;
    transition: all 0.2s;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
  }

  .mood-btn:active { transform: scale(0.97); }

  .mood-btn.selected {
    border-color: var(--warm);
    background: var(--warm-glow);
  }

  .mood-icon { font-size: 26px; line-height: 1; }

  .mood-label {
    font-size: 12px;
    color: var(--text-soft);
    letter-spacing: 0.5px;
  }

  .mood-btn.selected .mood-label { color: var(--warm); }

  /* Intensity slider */
  .intensity-wrap {
    margin-bottom: 32px;
  }

  .intensity-labels {
    display: flex;
    justify-content: space-between;
    font-size: 11px;
    color: var(--text-muted);
    margin-bottom: 12px;
    letter-spacing: 1px;
    text-transform: uppercase;
  }

  input[type=range] {
    width: 100%;
    -webkit-appearance: none;
    height: 2px;
    background: linear-gradient(to right, var(--warm) 0%, var(--warm) 50%, var(--text-muted) 50%);
    border-radius: 2px;
    outline: none;
  }

  input[type=range]::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background: var(--warm);
    cursor: pointer;
    box-shadow: 0 0 12px rgba(196, 149, 106, 0.4);
  }

  /* Text input */
  .rewind-textarea {
    width: 100%;
    background: var(--surface);
    border: 1px solid var(--border-soft);
    border-radius: 12px;
    padding: 18px;
    color: var(--text);
    font-family: 'Cormorant Garamond', serif;
    font-size: 20px;
    font-weight: 300;
    line-height: 1.6;
    resize: none;
    outline: none;
    min-height: 140px;
    transition: border-color 0.3s;
    margin-bottom: 12px;
  }

  .rewind-textarea::placeholder { color: var(--text-muted); font-style: italic; }
  .rewind-textarea:focus { border-color: var(--warm-soft); }

  .skip-link {
    font-size: 12px;
    color: var(--text-muted);
    text-align: center;
    cursor: pointer;
    padding: 8px;
    letter-spacing: 1px;
  }

  /* Focus input */
  .focus-input {
    background: var(--surface);
    border: 1px solid var(--border-soft);
    border-radius: 12px;
    padding: 18px;
    color: var(--text);
    font-family: 'Cormorant Garamond', serif;
    font-size: 22px;
    font-weight: 300;
    width: 100%;
    outline: none;
    transition: border-color 0.3s;
    margin-bottom: 12px;
  }

  .focus-input::placeholder { color: var(--text-muted); font-style: italic; }
  .focus-input:focus { border-color: var(--warm-soft); }

  .step-next {
    margin-top: auto;
    background: transparent;
    border: 1px solid var(--border);
    color: var(--warm);
    font-family: 'DM Sans', sans-serif;
    font-size: 12px;
    letter-spacing: 3px;
    text-transform: uppercase;
    padding: 16px;
    border-radius: 40px;
    cursor: pointer;
    width: 100%;
    transition: all 0.3s;
    margin-top: 32px;
  }

  .step-next:active {
    background: var(--warm-glow);
    transform: scale(0.98);
  }

  /* â”€â”€ REFLECTION SCREEN â”€â”€ */
  #screen-reflection {
    padding-top: 72px;
    padding-bottom: 60px;
  }

  .reflection-header {
    margin-bottom: 40px;
  }

  .reflection-eyebrow {
    font-size: 11px;
    letter-spacing: 3px;
    text-transform: uppercase;
    color: var(--warm-soft);
    margin-bottom: 12px;
  }

  .reflection-title {
    font-family: 'Cormorant Garamond', serif;
    font-size: 32px;
    font-weight: 300;
    color: var(--text);
    line-height: 1.3;
  }

  .reflection-card {
    background: var(--surface);
    border: 1px solid var(--border-soft);
    border-radius: 16px;
    padding: 24px;
    margin-bottom: 16px;
  }

  .reflection-card-label {
    font-size: 10px;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: var(--text-muted);
    margin-bottom: 10px;
  }

  .reflection-card-value {
    font-family: 'Cormorant Garamond', serif;
    font-size: 20px;
    color: var(--text);
    line-height: 1.5;
    font-style: italic;
  }

  .focus-card {
    background: var(--warm-glow);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 24px;
    margin-bottom: 24px;
  }

  .focus-card-label {
    font-size: 10px;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: var(--warm-soft);
    margin-bottom: 10px;
  }

  .focus-card-value {
    font-family: 'Cormorant Garamond', serif;
    font-size: 24px;
    color: var(--warm);
    line-height: 1.4;
  }

  .rewind-response {
    font-family: 'Cormorant Garamond', serif;
    font-size: 19px;
    font-style: italic;
    color: var(--text-soft);
    line-height: 1.7;
    padding: 24px 0;
    border-top: 1px solid var(--border-soft);
    border-bottom: 1px solid var(--border-soft);
    margin-bottom: 32px;
  }

  .done-btn {
    width: 100%;
    background: transparent;
    border: 1px solid var(--border);
    color: var(--warm);
    font-family: 'DM Sans', sans-serif;
    font-size: 12px;
    letter-spacing: 3px;
    text-transform: uppercase;
    padding: 16px;
    border-radius: 40px;
    cursor: pointer;
    transition: all 0.3s;
    margin-bottom: 16px;
  }

  .done-btn:active { background: var(--warm-glow); transform: scale(0.98); }

  .new-session-btn {
    width: 100%;
    background: transparent;
    border: none;
    color: var(--text-muted);
    font-family: 'DM Sans', sans-serif;
    font-size: 12px;
    letter-spacing: 1px;
    padding: 12px;
    cursor: pointer;
  }

  /* â”€â”€ HISTORY SCREEN â”€â”€ */
  #screen-history {
    padding-top: 72px;
    padding-bottom: 60px;
  }

  .history-header {
    margin-bottom: 32px;
  }

  .history-title {
    font-family: 'Cormorant Garamond', serif;
    font-size: 32px;
    font-weight: 300;
    color: var(--text);
    margin-bottom: 6px;
  }

  .history-sub {
    font-size: 13px;
    color: var(--text-muted);
  }

  .history-entry {
    background: var(--surface);
    border: 1px solid var(--border-soft);
    border-radius: 12px;
    padding: 18px 20px;
    margin-bottom: 12px;
  }

  .history-date {
    font-size: 11px;
    letter-spacing: 1px;
    color: var(--text-muted);
    text-transform: uppercase;
    margin-bottom: 8px;
  }

  .history-mood {
    font-size: 20px;
    margin-bottom: 6px;
  }

  .history-focus {
    font-family: 'Cormorant Garamond', serif;
    font-size: 17px;
    color: var(--warm);
    font-style: italic;
    margin-bottom: 6px;
  }

  .history-feeling {
    font-size: 13px;
    color: var(--text-soft);
    line-height: 1.5;
  }

  .empty-history {
    text-align: center;
    padding: 60px 20px;
    font-family: 'Cormorant Garamond', serif;
    font-size: 20px;
    color: var(--text-muted);
    font-style: italic;
    line-height: 1.6;
  }

  /* Bottom nav */
  .bottom-nav {
    position: fixed;
    bottom: 0;
    left: 0; right: 0;
    z-index: 10;
    display: flex;
    background: rgba(14, 11, 9, 0.92);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border-top: 1px solid var(--border-soft);
    padding: 12px 0 max(12px, env(safe-area-inset-bottom));
  }

  .nav-btn {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    background: none;
    border: none;
    cursor: pointer;
    padding: 4px 0;
    transition: opacity 0.2s;
  }

  .nav-icon {
    font-size: 20px;
    line-height: 1;
    filter: grayscale(1) opacity(0.4);
    transition: filter 0.3s;
  }

  .nav-label {
    font-size: 10px;
    letter-spacing: 1px;
    text-transform: uppercase;
    color: var(--text-muted);
    transition: color 0.3s;
  }

  .nav-btn.active .nav-icon { filter: none; }
  .nav-btn.active .nav-label { color: var(--warm); }

  /* Animations */
  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(12px); }
    to { opacity: 1; transform: translateY(0); }
  }

  @keyframes pulse {
    0%, 100% { opacity: 0.6; }
    50% { opacity: 1; }
  }

  /* Breathing orb on welcome */
  .breath-orb {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    background: radial-gradient(circle, rgba(196,149,106,0.3), rgba(196,149,106,0.05));
    margin: 0 auto 40px;
    animation: breathe 4s ease-in-out infinite;
    opacity: 0;
    animation-delay: 1.3s;
  }

  @keyframes breathe {
    0%, 100% { transform: scale(0.9); opacity: 0.5; }
    50% { transform: scale(1.1); opacity: 1; }
  }

  .breath-orb.loaded { opacity: 1; animation: breathe 4s ease-in-out infinite, fadeUp 0.8s ease 1.3s forwards; }
</style>
</head>
<body>

<div class="ambient">
  <div class="ambient-orb a1"></div>
  <div class="ambient-orb a2"></div>
</div>
<div class="grain"></div>

<div class="app">

  <!-- WELCOME -->
  <div class="screen active" id="screen-welcome">
    <div style="flex:1; display:flex; flex-direction:column; justify-content:center; align-items:center; text-align:center;">
      <p class="welcome-time" id="welcome-time">Evening</p>
      <div class="breath-orb" id="breath-orb"></div>
      <h1 class="rewind-logo">Rewind</h1>
      <p class="rewind-tagline">return to yourself</p>
      <div class="returning-msg" id="returning-msg">
        <span class="days-away" id="days-away-text"></span>
        <span id="returning-body"></span>
      </div>
      <p class="welcome-question" id="welcome-question">How are you coming in<br>right now?</p>
      <button class="begin-btn" id="begin-btn" onclick="startCheckin()">Begin</button>
    </div>
  </div>

  <!-- CHECK-IN -->
  <div class="screen" id="screen-checkin">

    <div class="step-indicator">
      <div class="step-dot active" id="dot-0"></div>
      <div class="step-dot" id="dot-1"></div>
      <div class="step-dot" id="dot-2"></div>
    </div>

    <!-- Step 1: Mood -->
    <div class="checkin-step active" id="step-0">
      <p class="step-q">What is the weather<br>inside you right now?</p>
      <p class="step-sub">Don't think too long. First feeling.</p>
      <div class="mood-grid">
        <button class="mood-btn" onclick="selectMood(this, 'Heavy')" data-mood="Heavy">
          <span class="mood-icon">ðŸŒ§</span>
          <span class="mood-label">Heavy</span>
        </button>
        <button class="mood-btn" onclick="selectMood(this, 'Tired')" data-mood="Tired">
          <span class="mood-icon">ðŸŒ«</span>
          <span class="mood-label">Tired</span>
        </button>
        <button class="mood-btn" onclick="selectMood(this, 'Restless')" data-mood="Restless">
          <span class="mood-icon">âš¡</span>
          <span class="mood-label">Restless</span>
        </button>
        <button class="mood-btn" onclick="selectMood(this, 'Okay')" data-mood="Okay">
          <span class="mood-icon">ðŸŒ¤</span>
          <span class="mood-label">Okay</span>
        </button>
        <button class="mood-btn" onclick="selectMood(this, 'Calm')" data-mood="Calm">
          <span class="mood-icon">ðŸŒŠ</span>
          <span class="mood-label">Calm</span>
        </button>
        <button class="mood-btn" onclick="selectMood(this, 'Alive')" data-mood="Alive">
          <span class="mood-icon">âœ¨</span>
          <span class="mood-label">Alive</span>
        </button>
      </div>
      <div class="intensity-wrap">
        <div class="intensity-labels"><span>Barely</span><span>How much?</span><span>Fully</span></div>
        <input type="range" id="intensity" min="1" max="10" value="5" oninput="updateIntensity(this)">
      </div>
      <button class="step-next" onclick="nextStep(1)">Continue â†’</button>
    </div>

    <!-- Step 2: Feeling / spark -->
    <div class="checkin-step" id="step-1">
      <p class="step-q">What's sitting<br>with you right now?</p>
      <p class="step-sub">A feeling, a thought, a spark of an idea. Anything. Even if it's half-formed.</p>
      <textarea class="rewind-textarea" id="feeling-input" placeholder="Just let it out here..." rows="5"></textarea>
      <p class="skip-link" onclick="skipFeeling()">Nothing right now â€” skip</p>
      <button class="step-next" onclick="nextStep(2)">Continue â†’</button>
    </div>

    <!-- Step 3: One focus -->
    <div class="checkin-step" id="step-2">
      <p class="step-q">What is the one thing<br>that matters today?</p>
      <p class="step-sub">Not a list. Just one. The truest, smallest next thing.</p>
      <input type="text" class="focus-input" id="focus-input" placeholder="One thing only...">
      <p class="skip-link" onclick="skipFocus()">Rest is the focus today</p>
      <button class="step-next" onclick="completeCheckin()">See my reflection â†’</button>
    </div>

  </div>

  <!-- REFLECTION -->
  <div class="screen" id="screen-reflection">
    <div class="reflection-header">
      <p class="reflection-eyebrow">Your check-in</p>
      <h2 class="reflection-title" id="reflection-title">Here is where<br>you are.</h2>
    </div>

    <div class="reflection-card">
      <p class="reflection-card-label">Weather inside</p>
      <p class="reflection-card-value" id="reflection-mood">â€”</p>
    </div>

    <div class="reflection-card" id="reflection-feeling-card">
      <p class="reflection-card-label">What you're carrying</p>
      <p class="reflection-card-value" id="reflection-feeling">â€”</p>
    </div>

    <div class="focus-card" id="reflection-focus-card">
      <p class="focus-card-label">One thing today</p>
      <p class="focus-card-value" id="reflection-focus">â€”</p>
    </div>

    <p class="rewind-response" id="rewind-response">â€”</p>

    <button class="done-btn" onclick="goHome()">Close for now</button>
    <button class="new-session-btn" onclick="startCheckin()">Start a new check-in</button>
  </div>

  <!-- HISTORY -->
  <div class="screen" id="screen-history">
    <div class="history-header">
      <h2 class="history-title">Your pattern</h2>
      <p class="history-sub">Every check-in, remembered.</p>
    </div>
    <div id="history-list"></div>
  </div>

</div>

<!-- Bottom nav -->
<nav class="bottom-nav" id="bottom-nav" style="display:none;">
  <button class="nav-btn active" id="nav-home" onclick="navigate('welcome')">
    <span class="nav-icon">ðŸŒ¬</span>
    <span class="nav-label">Rewind</span>
  </button>
  <button class="nav-btn" id="nav-checkin" onclick="startCheckin()">
    <span class="nav-icon">â—‹</span>
    <span class="nav-label">Check in</span>
  </button>
  <button class="nav-btn" id="nav-history" onclick="navigate('history')">
    <span class="nav-icon">â—Ž</span>
    <span class="nav-label">Pattern</span>
  </button>
</nav>

<script>
// â”€â”€ STATE â”€â”€
let state = {
  mood: null,
  intensity: 5,
  feeling: '',
  focus: '',
  currentStep: 0
};

let sessions = [];

// â”€â”€ STORAGE â”€â”€
function saveSession(session) {
  try {
    sessions.push(session);
    localStorage.setItem('rewind_sessions', JSON.stringify(sessions));
  } catch(e) { sessions.push(session); }
}

function loadSessions() {
  try {
    const s = localStorage.getItem('rewind_sessions');
    if (s) sessions = JSON.parse(s);
  } catch(e) { sessions = []; }
}

function getLastSession() {
  return sessions.length > 0 ? sessions[sessions.length - 1] : null;
}

function getDaysSince(dateStr) {
  const then = new Date(dateStr);
  const now = new Date();
  return Math.floor((now - then) / (1000 * 60 * 60 * 24));
}

// â”€â”€ INIT â”€â”€
function init() {
  loadSessions();

  // Ambient orbs
  setTimeout(() => {
    document.querySelectorAll('.ambient-orb').forEach(o => o.classList.add('visible'));
  }, 500);

  // Breathing orb
  setTimeout(() => {
    document.getElementById('breath-orb').classList.add('loaded');
  }, 100);

  // Time greeting
  const hour = new Date().getHours();
  let timeLabel = 'Evening';
  let question = 'How are you coming in\nright now?';
  if (hour >= 5 && hour < 12) { timeLabel = 'Morning'; question = 'How are you waking\ninto today?'; }
  else if (hour >= 12 && hour < 17) { timeLabel = 'Afternoon'; question = 'How is the day\nsitting with you?'; }
  else if (hour >= 17 && hour < 20) { timeLabel = 'Evening'; question = 'How are you coming\nhome today?'; }
  else { timeLabel = 'Late night'; question = 'The quiet hour.\nHow are you, really?'; }

  document.getElementById('welcome-time').textContent = timeLabel;
  document.getElementById('welcome-question').textContent = question;

  // Returning user
  const last = getLastSession();
  if (last) {
    const days = getDaysSince(last.date);
    const returning = document.getElementById('returning-msg');
    returning.classList.add('show');

    if (days === 0) {
      document.getElementById('days-away-text').textContent = 'Welcome back.';
      document.getElementById('returning-body').textContent = `You were here earlier today. The space is still here.`;
    } else if (days === 1) {
      document.getElementById('days-away-text').textContent = 'Yesterday you were here.';
      document.getElementById('returning-body').textContent = `Your focus was: "${last.focus || 'rest'}". You're back. That's what matters.`;
    } else if (days <= 7) {
      document.getElementById('days-away-text').textContent = `${days} days since your last check-in.`;
      document.getElementById('returning-body').textContent = `No judgment. You're here now. The space held.`;
    } else {
      document.getElementById('days-away-text').textContent = `It's been a while.`;
      document.getElementById('returning-body').textContent = `${days} days. The cocoon does what it needs to. Welcome back â€” no streak broken, nothing lost.`;
    }

    document.getElementById('welcome-question').style.display = 'none';
  }

  // Show nav after first init
  if (sessions.length > 0) {
    document.getElementById('bottom-nav').style.display = 'flex';
  }
}

// â”€â”€ NAVIGATION â”€â”€
function showScreen(id) {
  document.querySelectorAll('.screen').forEach(s => {
    s.classList.remove('active', 'exit');
  });
  setTimeout(() => {
    document.getElementById('screen-' + id).classList.add('active');
  }, 50);

  // Nav state
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  if (id === 'welcome') document.getElementById('nav-home').classList.add('active');
  if (id === 'history') document.getElementById('nav-history').classList.add('active');
  if (id === 'checkin') document.getElementById('nav-checkin').classList.add('active');
}

function navigate(screen) {
  if (screen === 'history') renderHistory();
  showScreen(screen);
}

function goHome() {
  document.getElementById('bottom-nav').style.display = 'flex';
  showScreen('welcome');
  document.getElementById('nav-home').classList.add('active');
}

// â”€â”€ CHECK-IN FLOW â”€â”€
function startCheckin() {
  state = { mood: null, intensity: 5, feeling: '', focus: '', currentStep: 0 };
  document.querySelectorAll('.mood-btn').forEach(b => b.classList.remove('selected'));
  document.getElementById('feeling-input').value = '';
  document.getElementById('focus-input').value = '';
  document.getElementById('intensity').value = 5;
  updateIntensity(document.getElementById('intensity'));

  setStep(0);
  showScreen('checkin');
  document.getElementById('nav-checkin').classList.add('active');
}

function setStep(n) {
  document.querySelectorAll('.checkin-step').forEach((s, i) => {
    s.classList.toggle('active', i === n);
  });
  document.querySelectorAll('.step-dot').forEach((d, i) => {
    d.classList.remove('active', 'done');
    if (i < n) d.classList.add('done');
    if (i === n) d.classList.add('active');
  });
  state.currentStep = n;
}

function selectMood(btn, mood) {
  document.querySelectorAll('.mood-btn').forEach(b => b.classList.remove('selected'));
  btn.classList.add('selected');
  state.mood = mood;
}

function updateIntensity(input) {
  const val = input.value;
  const pct = ((val - 1) / 9) * 100;
  input.style.background = `linear-gradient(to right, var(--warm) 0%, var(--warm) ${pct}%, var(--text-muted) ${pct}%)`;
  state.intensity = parseInt(val);
}

function nextStep(n) {
  if (n === 1 && !state.mood) {
    state.mood = 'Okay';
  }
  setStep(n);
}

function skipFeeling() {
  state.feeling = '';
  setStep(2);
}

function skipFocus() {
  state.focus = 'Rest';
  completeCheckin();
}

function completeCheckin() {
  state.feeling = document.getElementById('feeling-input').value.trim();
  state.focus = document.getElementById('focus-input').value.trim() || state.focus || 'Rest';

  const session = {
    date: new Date().toISOString(),
    mood: state.mood || 'Okay',
    intensity: state.intensity,
    feeling: state.feeling,
    focus: state.focus
  };

  saveSession(session);
  renderReflection(session);
  showScreen('reflection');
  document.getElementById('bottom-nav').style.display = 'flex';
}

// â”€â”€ REFLECTION â”€â”€
const responses = {
  Heavy: [
    "Heavy is real. You don't have to carry it gracefully right now. Just carry it.",
    "Something is weighing on you. That's okay. You showed up anyway.",
    "Let the heaviness be here. You don't have to fix it tonight."
  ],
  Tired: [
    "Tired is honest. You've been doing a lot. Rest is not falling behind.",
    "Your body is asking for something. Listen when you can.",
    "The tiredness is information. It's telling you something true."
  ],
  Restless: [
    "The restlessness wants to go somewhere. One small thing, not everything.",
    "That energy is real. Channel just one part of it tonight.",
    "Restless often means something is ready to move. Be curious about what."
  ],
  Okay: [
    "Okay is enough. Not every day needs to be more than this.",
    "Okay is stable ground. You can build from here.",
    "Okay means you're here, holding things. That counts."
  ],
  Calm: [
    "Calm is rare. Let yourself receive it.",
    "This is a good moment to let something go that you've been holding.",
    "Calm is the weather your best thinking happens in."
  ],
  Alive: [
    "Hold onto this feeling. It's data about what matters to you.",
    "Notice what brought this. It's pointing at something real.",
    "This is you at your most you. Remember it for the harder days."
  ]
};

function getResponse(mood, focus) {
  const moodResponses = responses[mood] || responses['Okay'];
  let r = moodResponses[Math.floor(Math.random() * moodResponses.length)];
  if (focus && focus !== 'Rest') {
    r += ` Your one thing today: "${focus}." Just that. Nothing else needs to happen.`;
  } else if (focus === 'Rest') {
    r += ' Rest is the right choice. Let it be enough.';
  }
  return r;
}

function renderReflection(session) {
  const moodIcons = { Heavy:'ðŸŒ§', Tired:'ðŸŒ«', Restless:'âš¡', Okay:'ðŸŒ¤', Calm:'ðŸŒŠ', Alive:'âœ¨' };
  const icon = moodIcons[session.mood] || 'â—‹';

  document.getElementById('reflection-mood').textContent =
    `${icon}  ${session.mood}  Â·  ${session.intensity}/10`;

  if (session.feeling) {
    document.getElementById('reflection-feeling').textContent = session.feeling;
    document.getElementById('reflection-feeling-card').style.display = 'block';
  } else {
    document.getElementById('reflection-feeling-card').style.display = 'none';
  }

  document.getElementById('reflection-focus').textContent = session.focus;
  document.getElementById('rewind-response').textContent = getResponse(session.mood, session.focus);

  const titles = { Heavy: 'Be gentle\nwith yourself.', Tired: 'You can rest\nhere first.', Restless: 'One thing.\nNot everything.', Okay: 'Here is where\nyou are.', Calm: 'Receive\nthis moment.', Alive: 'Hold onto\nthis.' };
  document.getElementById('reflection-title').textContent = titles[session.mood] || 'Here is where\nyou are.';
}

// â”€â”€ HISTORY â”€â”€
function renderHistory() {
  const list = document.getElementById('history-list');
  if (sessions.length === 0) {
    list.innerHTML = '<div class="empty-history">Your check-ins will appear here.<br>Each one is a data point<br>in understanding yourself.</div>';
    return;
  }

  const moodIcons = { Heavy:'ðŸŒ§', Tired:'ðŸŒ«', Restless:'âš¡', Okay:'ðŸŒ¤', Calm:'ðŸŒŠ', Alive:'âœ¨' };
  const reversed = [...sessions].reverse();

  list.innerHTML = reversed.map(s => {
    const d = new Date(s.date);
    const dateStr = d.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' });
    const timeStr = d.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit' });
    const icon = moodIcons[s.mood] || 'â—‹';
    return `
      <div class="history-entry">
        <p class="history-date">${dateStr}  Â·  ${timeStr}</p>
        <p class="history-mood">${icon} ${s.mood} Â· ${s.intensity}/10</p>
        ${s.focus ? `<p class="history-focus">"${s.focus}"</p>` : ''}
        ${s.feeling ? `<p class="history-feeling">${s.feeling.substring(0, 120)}${s.feeling.length > 120 ? '...' : ''}</p>` : ''}
      </div>
    `;
  }).join('');
}

// Start
init();
</script>
</body>
</html>
